<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0056)http://www.haskell.org/haskellwiki/99_questions/95_to_99 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		
				<meta name="keywords" content="99 questions/95 to 99,99 questions/Solutions/95,99 questions/Solutions/96,99 questions/Solutions/97,99 questions/Solutions/98,99 questions/Solutions/99,H-99: Ninety-Nine Haskell Problems">
		<link rel="shortcut icon" href="http://www.haskell.org/favicon.ico">
		<link rel="search" type="application/opensearchdescription+xml" href="http://www.haskell.org/haskellwiki/opensearch_desc.php" title="HaskellWiki (English)">
		<link title="Creative Commons" type="application/rdf+xml" href="http://www.haskell.org/haskellwiki/index.php?title=99_questions/95_to_99&action=creativecommons" rel="meta">
		<link rel="copyright" href="http://www.haskell.org/haskellwiki/HaskellWiki:Copyrights">
<link rel="alternate" type="application/rss+xml" title="HaskellWiki RSS Feed" href="http://www.haskell.org/haskellwiki/index.php?title=Special:Recentchanges&feed=rss">
<link rel="alternate" type="application/atom+xml" title="HaskellWiki Atom Feed" href="http://www.haskell.org/haskellwiki/index.php?title=Special:Recentchanges&feed=atom">
		<title>99 questions/95 to 99 - HaskellWiki</title>
		<style type="text/css" media="screen, projection">/*<![CDATA[*/
			@import "/wikistatic/skins//common/shared.css?116";
			@import "/wikistatic/skins//hawiki/main.css?116";
		/*]]>*/</style>
		<link rel="stylesheet" type="text/css" media="print" href="./99 questions 95 to 99 - HaskellWiki_files/commonPrint.css">
		<!--[if lt IE 5.5000]><style type="text/css">@import "/wikistatic/skins//hawiki/IE50Fixes.css?116";</style><![endif]-->
		<!--[if IE 5.5000]><style type="text/css">@import "/wikistatic/skins//hawiki/IE55Fixes.css?116";</style><![endif]-->
		<!--[if IE 6]><style type="text/css">@import "/wikistatic/skins//hawiki/IE60Fixes.css?116";</style><![endif]-->
		<!--[if IE 7]><style type="text/css">@import "/wikistatic/skins//hawiki/IE70Fixes.css?116";</style><![endif]-->
		<!--[if lte IE 7]><script type="text/javascript" src="/wikistatic/skins//hawiki/IEFixes.js?116"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->
                                                <script type="text/javascript" async="" src="./99 questions 95 to 99 - HaskellWiki_files/ga.js"></script><script type="text/javascript">
                        var isMSIE55 = (window.showModalDialog && window.clipboardData && window.createPopup); /*alert("test: " + isMSIE55);*/</script>

		<script type="text/javascript">/*<![CDATA[*/
var skin = "hawiki";
var stylepath = "/wikistatic/skins/";
var wgArticlePath = "/haskellwiki/$1";
var wgScriptPath = "/haskellwiki";
var wgScript = "/haskellwiki/index.php";
var wgServer = "http://www.haskell.org";
var wgCanonicalNamespace = "";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 0;
var wgPageName = "99_questions/95_to_99";
var wgTitle = "99 questions/95 to 99";
var wgAction = "view";
var wgRestrictionEdit = [];
var wgRestrictionMove = [];
var wgArticleId = "2506";
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "en";
var wgContentLanguage = "en";
var wgBreakFrames = false;
var wgCurRevisionId = "36225";
var wgVersion = "1.12.0";
var wgEnableAPI = true;
var wgEnableWriteAPI = false;
/*]]>*/</script>

		<script type="text/javascript" src="./99 questions 95 to 99 - HaskellWiki_files/wikibits.js"><!-- wikibits js --></script><link rel="stylesheet" type="text/css" href="./99 questions 95 to 99 - HaskellWiki_files/KHTMLFixes.css">
		<!-- Head Scripts -->
		<script type="text/javascript" src="./99 questions 95 to 99 - HaskellWiki_files/ajax.js"></script>
<style type="text/css">/*<![CDATA[*/
.source-haskell {line-height: normal;}
.source-haskell li {line-height: normal;}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for haskell
 * CSS class: source-haskell, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.source-haskell .de1, .source-haskell .de2 {font-family: 'Courier New', Courier, monospace; font-weight: normal; font-style: normal;}
.source-haskell  {}
.source-haskell .head {}
.source-haskell .foot {}
.source-haskell .imp {font-weight: bold; color: red;}
.source-haskell li, .source-haskell li.li1 {font-weight: normal;}
.source-haskell li.li2 {font-weight: bold;}
.source-haskell .kw1 {color: #06c; font-weight: bold;}
.source-haskell .kw2 {color: #06c; font-weight: bold;}
.source-haskell .kw3 {font-weight: bold;}
.source-haskell .kw4 {color: #cccc00; font-weight: bold;}
.source-haskell .kw5 {color: maroon;}
.source-haskell .co1 {color: #5d478b; font-style: italic;}
.source-haskell .co2 {color: #339933; font-weight: bold;}
.source-haskell .coMULTI {color: #5d478b; font-style: italic;}
.source-haskell .es0 {background-color: #3cb371; font-weight: bold;}
.source-haskell .br0 {color: green;}
.source-haskell .sy0 {color: #339933; font-weight: bold;}
.source-haskell .st0 {background-color: #3cb371;}
.source-haskell .nu0 {color: red;}
.source-haskell .me1 {color: #060;}
.source-haskell .ln-xtra, .source-haskell li.ln-xtra, .source-haskell div.ln-xtra {color: #cc0; background-color: #ffc;}

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "/haskellwiki/index.php?title=MediaWiki:Geshi.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
/*]]>*/
</style>		<script type="text/javascript" src="./99 questions 95 to 99 - HaskellWiki_files/index.php"><!-- site js --></script>
		<style type="text/css">/*<![CDATA[*/
@import "/haskellwiki/index.php?title=MediaWiki:Common.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
@import "/haskellwiki/index.php?title=MediaWiki:Hawiki.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
@import "/haskellwiki/index.php?title=-&action=raw&gen=css&maxage=18000&useskin=hawiki";
/*]]>*/</style>
	</head>
<body class="mediawiki ltr page-99_questions_95_to_99  hasGoogleVoiceExt">
   <div id="topbar" class="noprint">
	<div class="portlet noprint" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul><li><a class="homebutton" href="http://www.haskell.org/haskellwiki/Haskell">Home</a></li>
				<li id="pt-login"><a href="http://www.haskell.org/haskellwiki/index.php?title=Special:Userlogin&returnto=99_questions/95_to_99" title="You are encouraged to log in, it is not mandatory however. [o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
        	  <div id="p-search">
	    <div id="searchBody" class="pBody">
	       <form action="http://www.haskell.org/haskellwiki/index.php" id="searchform"><div>
	          <input type="hidden" name="title" value="">
	          <input id="searchInput" name="search" type="text" title="Search HaskellWiki [ctrl-f]" accesskey="f" value="">
				<input type="submit" name="go" class="searchButton" id="searchGoButton" value="Go" title="Go to a page with this exact name if exists">&nbsp;
				<input type="submit" name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text">

	         </div></form>
	    </div>
	  </div>
   </div>
	<div id="globalWrapper">
	<div class="portlet" id="p-logo">
		<a style="background-image: url(/wikistatic/haskellwiki_logo.png);" href="http://www.haskell.org/haskellwiki/Haskell" title="Main Page"></a>
	</div>
	<div id="column-content">
        <div id="notice-area" class="noprint">
        <!-- ?php $this->data['sitenotice'] = 'This is a test instance.  Do not edit, your changes will be lost.'; ? -->
			        </div>
        <div id="content-wrapper">
	<div id="p-cactions" class="portlet noprint">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="./99 questions 95 to 99 - HaskellWiki_files/99 questions 95 to 99 - HaskellWiki.html" title="View the content page [c]" accesskey="c">Page</a></li>
				 <li id="ca-talk" class="new"><a href="http://www.haskell.org/haskellwiki/index.php?title=Talk:99_questions/95_to_99&action=edit" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-viewsource"><a href="http://www.haskell.org/haskellwiki/index.php?title=99_questions/95_to_99&action=edit" title="This page is protected. You can view its source. [e]" accesskey="e">View source</a></li>
				 <li id="ca-history"><a href="http://www.haskell.org/haskellwiki/index.php?title=99_questions/95_to_99&action=history" title="Past versions of this page. [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
                        <div id="content">
		<a name="top" id="top"></a>
                        <h1 id="firstHeading" class="firstHeading">99 questions/95 to 99</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From HaskellWiki</h3>
			<div id="contentSub"><span class="subpages">&lt; <a href="http://www.haskell.org/haskellwiki/99_questions" class="mw-redirect" title="99 questions">99 questions</a></span></div>
			<div id="jump-to-nav">Jump to: <a href="http://www.haskell.org/haskellwiki/99_questions/95_to_99#column-one">navigation</a>, <a href="http://www.haskell.org/haskellwiki/99_questions/95_to_99#searchInput">search</a></div>			<!-- start content -->
			<p><br>
This is part of <a href="http://www.haskell.org/haskellwiki/H-99:_Ninety-Nine_Haskell_Problems" title="H-99: Ninety-Nine Haskell Problems">Ninety-Nine Haskell Problems</a>, based on <a href="https://prof.ti.bfh.ch/hew1/informatik3/prolog/p-99/" class="external text" title="https://prof.ti.bfh.ch/hew1/informatik3/prolog/p-99/" rel="nofollow">Ninety-Nine Prolog Problems</a>.
</p>
<a name="Miscellaneous_problems"></a><h2> <span class="mw-headline">1  Miscellaneous problems </span></h2>
<a name="Problem_95"></a><h2> <span class="mw-headline">2  Problem 95 </span></h2>
<p>(**) English number words
</p><p>On financial documents, like cheques, numbers must sometimes be written in full words. Example: 175 must be written as one-seven-five. Write a predicate full-words/1 to print (non-negative) integer numbers in full words.
</p><p>Example in Haskell:
</p>
<div dir="ltr" style="text-align: left;"><pre class="source-haskell"><span class="sy0">&gt;</span> fullWords <span class="nu0">175</span>
one<span class="sy0">-</span>seven<span class="sy0">-</span>five</pre></div>
<p><a href="http://www.haskell.org/haskellwiki/99_questions/Solutions/95" title="99 questions/Solutions/95"> Solutions</a>
</p><p><br>
</p>
<a name="Problem_96"></a><h2> <span class="mw-headline">3  Problem 96 </span></h2>
<p>(**) Syntax checker
</p><p>In a certain programming language (Ada) identifiers are defined by the syntax diagram below.
</p><p><img src="./99 questions 95 to 99 - HaskellWiki_files/p96.gif" alt="p96.gif">
</p><p>Transform the syntax diagram into a system of syntax diagrams which do not contain loops; i.e. which are purely recursive. Using these modified diagrams, write a predicate identifier/1 that can check whether or not a given string is a legal identifier.
</p><p>Example in Prolog:
</p>
<pre>% identifier(Str)&nbsp;:- Str is a legal identifier 
</pre>
<p>Example in Haskell:
</p>
<div dir="ltr" style="text-align: left;"><pre class="source-haskell"><span class="sy0">&gt;</span> identifier <span class="st0">"this-is-a-long-identifier"</span>
True
<span class="sy0">&gt;</span> identifier <span class="st0">"this-ends-in-"</span>            
False
<span class="sy0">&gt;</span> identifier <span class="st0">"two--hyphens"</span> 
False</pre></div>
<p><a href="http://www.haskell.org/haskellwiki/99_questions/Solutions/96" title="99 questions/Solutions/96"> Solutions</a>
</p><p><br>
</p>
<a name="Problem_97"></a><h2> <span class="mw-headline">4  Problem 97 </span></h2>
<p>(**) Sudoku
</p><p>Sudoku puzzles go like this:
</p>
<pre>       Problem statement                 Solution

        .  .  4 | 8  .  . | .  1  7	     9  3  4 | 8  2  5 | 6  1  7	     
                |         |                          |         |
        6  7  . | 9  .  . | .  .  .	     6  7  2 | 9  1  4 | 8  5  3
                |         |                          |         |
        5  .  8 | .  3  . | .  .  4          5  1  8 | 6  3  7 | 9  2  4
        --------+---------+--------          --------+---------+--------
        3  .  . | 7  4  . | 1  .  .          3  2  5 | 7  4  8 | 1  6  9
                |         |                          |         |
        .  6  9 | .  .  . | 7  8  .          4  6  9 | 1  5  3 | 7  8  2
                |         |                          |         |
        .  .  1 | .  6  9 | .  .  5          7  8  1 | 2  6  9 | 4  3  5
        --------+---------+--------          --------+---------+--------
        1  .  . | .  8  . | 3  .  6	     1  9  7 | 5  8  2 | 3  4  6
                |         |                          |         |
        .  .  . | .  .  6 | .  9  1	     8  5  3 | 4  7  6 | 2  9  1
                |         |                          |         |
        2  4  . | .  .  1 | 5  .  .          2  4  6 | 3  9  1 | 5  7  8
</pre>  
<p>Every spot in the puzzle belongs to a (horizontal) row and a (vertical) column, as well as to one single 3x3 square (which we call "square" for short). At the beginning, some of the spots carry a single-digit number between 1 and 9. The problem is to fill the missing spots with digits in such a way that every number between 1 and 9 appears exactly once in each row, in each column, and in each square. 
</p><p><a href="http://www.haskell.org/haskellwiki/99_questions/Solutions/97" class="mw-redirect" title="99 questions/Solutions/97"> Solutions</a>
</p><p><br>        
</p>
<a name="Problem_98"></a><h2> <span class="mw-headline">5  Problem 98 </span></h2>
<p>(***) Nonograms
</p><p>Around 1994, a certain kind of puzzle was very popular in England. The "Sunday Telegraph" newspaper wrote: "Nonograms are puzzles from Japan and are currently published each week only in The Sunday Telegraph. Simply use your logic and skill to complete the grid and reveal a picture or diagram." As a Prolog programmer, you are in a better situation: you can have your computer do the work! Just write a little program&nbsp;;-).
</p><p>The puzzle goes like this: Essentially, each row and column of a rectangular bitmap is annotated with the respective lengths of its distinct strings of occupied cells. The person who solves the puzzle must complete the bitmap given only these lengths.
</p>
<pre>             Problem statement:          Solution:
</pre>
<pre>             |_|_|_|_|_|_|_|_| 3         |_|X|X|X|_|_|_|_| 3           
             |_|_|_|_|_|_|_|_| 2 1       |X|X|_|X|_|_|_|_| 2 1         
             |_|_|_|_|_|_|_|_| 3 2       |_|X|X|X|_|_|X|X| 3 2         
             |_|_|_|_|_|_|_|_| 2 2       |_|_|X|X|_|_|X|X| 2 2         
             |_|_|_|_|_|_|_|_| 6         |_|_|X|X|X|X|X|X| 6           
             |_|_|_|_|_|_|_|_| 1 5       |X|_|X|X|X|X|X|_| 1 5         
             |_|_|_|_|_|_|_|_| 6         |X|X|X|X|X|X|_|_| 6           
             |_|_|_|_|_|_|_|_| 1         |_|_|_|_|X|_|_|_| 1           
             |_|_|_|_|_|_|_|_| 2         |_|_|_|X|X|_|_|_| 2           
              1 3 1 7 5 3 4 3             1 3 1 7 5 3 4 3              
              2 1 5 1                     2 1 5 1                      
      
</pre>
<p>For the example above, the problem can be stated as the two lists [[3],[2,1],[3,2],[2,2],[6],[1,5],[6],[1],[2]] and [[1,2],[3,1],[1,5],[7,1],[5],[3],[4],[3]] which give the "solid" lengths of the rows and columns, top-to-bottom and left-to-right, respectively. Published puzzles are larger than this example, e.g. 25 x 20, and apparently always have unique solutions.
</p><p>Example in Haskell:
</p>
<div dir="ltr" style="text-align: left;"><pre class="source-haskell">Nonogram<span class="sy0">&gt;</span> <span class="kw3">putStr</span> <span class="sy0">$</span> nonogram <span class="br0">[</span><span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span><span class="sy0">,</span><span class="br0">[</span><span class="nu0">2</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">,</span><span class="br0">[</span><span class="nu0">3</span><span class="sy0">,</span><span class="nu0">2</span><span class="br0">]</span><span class="sy0">,</span><span class="br0">[</span><span class="nu0">2</span><span class="sy0">,</span><span class="nu0">2</span><span class="br0">]</span><span class="sy0">,</span><span class="br0">[</span><span class="nu0">6</span><span class="br0">]</span><span class="sy0">,</span><span class="br0">[</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">5</span><span class="br0">]</span><span class="sy0">,</span><span class="br0">[</span><span class="nu0">6</span><span class="br0">]</span><span class="sy0">,</span><span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">,</span><span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="br0">]</span> <span class="br0">[</span><span class="br0">[</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">2</span><span class="br0">]</span><span class="sy0">,</span><span class="br0">[</span><span class="nu0">3</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">,</span><span class="br0">[</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">5</span><span class="br0">]</span><span class="sy0">,</span><span class="br0">[</span><span class="nu0">7</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">,</span><span class="br0">[</span><span class="nu0">5</span><span class="br0">]</span><span class="sy0">,</span><span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span><span class="sy0">,</span><span class="br0">[</span><span class="nu0">4</span><span class="br0">]</span><span class="sy0">,</span><span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span><span class="br0">]</span>
<span class="sy0">|_|</span>X<span class="sy0">|</span>X<span class="sy0">|</span>X<span class="sy0">|_|_|_|_|</span> <span class="nu0">3</span>
<span class="sy0">|</span>X<span class="sy0">|</span>X<span class="sy0">|_|</span>X<span class="sy0">|_|_|_|_|</span> <span class="nu0">2</span> <span class="nu0">1</span>
<span class="sy0">|_|</span>X<span class="sy0">|</span>X<span class="sy0">|</span>X<span class="sy0">|_|_|</span>X<span class="sy0">|</span>X<span class="sy0">|</span> <span class="nu0">3</span> <span class="nu0">2</span>
<span class="sy0">|_|_|</span>X<span class="sy0">|</span>X<span class="sy0">|_|_|</span>X<span class="sy0">|</span>X<span class="sy0">|</span> <span class="nu0">2</span> <span class="nu0">2</span>
<span class="sy0">|_|_|</span>X<span class="sy0">|</span>X<span class="sy0">|</span>X<span class="sy0">|</span>X<span class="sy0">|</span>X<span class="sy0">|</span>X<span class="sy0">|</span> <span class="nu0">6</span>
<span class="sy0">|</span>X<span class="sy0">|_|</span>X<span class="sy0">|</span>X<span class="sy0">|</span>X<span class="sy0">|</span>X<span class="sy0">|</span>X<span class="sy0">|_|</span> <span class="nu0">1</span> <span class="nu0">5</span>
<span class="sy0">|</span>X<span class="sy0">|</span>X<span class="sy0">|</span>X<span class="sy0">|</span>X<span class="sy0">|</span>X<span class="sy0">|</span>X<span class="sy0">|_|_|</span> <span class="nu0">6</span>
<span class="sy0">|_|_|_|_|</span>X<span class="sy0">|_|_|_|</span> <span class="nu0">1</span>
<span class="sy0">|_|_|_|</span>X<span class="sy0">|</span>X<span class="sy0">|_|_|_|</span> <span class="nu0">2</span>
 <span class="nu0">1</span> <span class="nu0">3</span> <span class="nu0">1</span> <span class="nu0">7</span> <span class="nu0">5</span> <span class="nu0">3</span> <span class="nu0">4</span> <span class="nu0">3</span>
 <span class="nu0">2</span> <span class="nu0">1</span> <span class="nu0">5</span> <span class="nu0">1</span></pre></div>
<p><a href="http://www.haskell.org/haskellwiki/99_questions/Solutions/98" class="mw-redirect" title="99 questions/Solutions/98"> Solutions</a>
</p><p><br>
</p>
<a name="Problem_99"></a><h2> <span class="mw-headline">6  Problem 99 </span></h2>
<p>(***) Crossword puzzle
</p><p>Given an empty (or almost empty) framework of a crossword puzzle and a set of words. The problem is to place the words into the framework.
</p><p><img src="./99 questions 95 to 99 - HaskellWiki_files/p99.gif" alt="p99.gif">
</p><p>The particular crossword puzzle is specified in a text file which first lists the words (one word per line) in an arbitrary order. Then, after an empty line, the crossword framework is defined. In this framework specification, an empty character location is represented by a dot (.). In order to make the solution easier, character locations can also contain predefined character values. The puzzle above is defined in the file <a href="http://www.hta-bi.bfh.ch/~hew/informatik3/prolog/p-99/p99a.dat" class="external text" title="http://www.hta-bi.bfh.ch/~hew/informatik3/prolog/p-99/p99a.dat" rel="nofollow">p99a.dat</a>, other examples are <a href="http://www.hta-bi.bfh.ch/~hew/informatik3/prolog/p-99/p99b.dat" class="external text" title="http://www.hta-bi.bfh.ch/~hew/informatik3/prolog/p-99/p99b.dat" rel="nofollow">p99b.dat</a> and <a href="http://www.hta-bi.bfh.ch/~hew/informatik3/prolog/p-99/p99d.dat" class="external text" title="http://www.hta-bi.bfh.ch/~hew/informatik3/prolog/p-99/p99d.dat" rel="nofollow">p99d.dat</a>. There is also an example of a puzzle (<a href="http://www.hta-bi.bfh.ch/~hew/informatik3/prolog/p-99/p99c.dat" class="external text" title="http://www.hta-bi.bfh.ch/~hew/informatik3/prolog/p-99/p99c.dat" rel="nofollow">p99c.dat</a>) which does not have a solution.
</p><p>Words are strings (character lists) of at least two characters. A horizontal or vertical sequence of character places in the crossword puzzle framework is called a site. Our problem is to find a compatible way of placing words onto sites.
</p><p>Hints: (1) The problem is not easy. You will need some time to thoroughly understand it. So, don't give up too early! And remember that the objective is a clean solution, not just a quick-and-dirty hack!
</p><p>(2) Reading the data file is a tricky problem for which a solution is provided in the file <a href="http://www.hta-bi.bfh.ch/~hew/informatik3/prolog/p-99/p99-readfile.pl" class="external text" title="http://www.hta-bi.bfh.ch/~hew/informatik3/prolog/p-99/p99-readfile.pl" rel="nofollow">p99-readfile.pl</a>. See the predicate read_lines/2.
</p><p>(3) For efficiency reasons it is important, at least for larger puzzles, to sort the words and the sites in a particular order. For this part of the problem, the solution of P28 may be very helpful. 
</p><p>Example in Haskell:
</p>
<pre>ALPHA
ARES
POPPY

  .
  .
.....
  . .
  . .
    .
</pre>
<div dir="ltr" style="text-align: left;"><pre class="source-haskell"><span class="sy0">&gt;</span> solve <span class="sy0">$</span> readCrossword <span class="st0">"ALPHA<span class="es0">\n</span>ARES<span class="es0">\n</span>POPPY<span class="es0">\n</span><span class="es0">\n</span>  .  <span class="es0">\n</span>  .  <span class="es0">\n</span>.....<span class="es0">\n</span>  . .<span class="es0">\n</span>  . .<span class="es0">\n</span>    .<span class="es0">\n</span>"</span>
&nbsp;
<span class="br0">[</span><span class="br0">[</span><span class="br0">(</span><span class="br0">(</span><span class="nu0">3</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">)</span><span class="sy0">,</span>'A'<span class="br0">)</span><span class="sy0">,</span><span class="br0">(</span><span class="br0">(</span><span class="nu0">3</span><span class="sy0">,</span><span class="nu0">2</span><span class="br0">)</span><span class="sy0">,</span>'L'<span class="br0">)</span><span class="sy0">,</span><span class="br0">(</span><span class="br0">(</span><span class="nu0">3</span><span class="sy0">,</span><span class="nu0">3</span><span class="br0">)</span><span class="sy0">,</span>'P'<span class="br0">)</span><span class="sy0">,</span><span class="br0">(</span><span class="br0">(</span><span class="nu0">3</span><span class="sy0">,</span><span class="nu0">4</span><span class="br0">)</span><span class="sy0">,</span>'H'<span class="br0">)</span><span class="sy0">,</span><span class="br0">(</span><span class="br0">(</span><span class="nu0">3</span><span class="sy0">,</span><span class="nu0">5</span><span class="br0">)</span><span class="sy0">,</span>'A'<span class="br0">)</span><span class="sy0">,</span><span class="br0">(</span><span class="br0">(</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">3</span><span class="br0">)</span><span class="sy0">,</span>'P'<span class="br0">)</span><span class="sy0">,</span><span class="br0">(</span><span class="br0">(</span><span class="nu0">2</span><span class="sy0">,</span><span class="nu0">3</span><span class="br0">)</span>
<span class="sy0">,</span>'O'<span class="br0">)</span><span class="sy0">,</span><span class="br0">(</span><span class="br0">(</span><span class="nu0">3</span><span class="sy0">,</span><span class="nu0">3</span><span class="br0">)</span><span class="sy0">,</span>'P'<span class="br0">)</span><span class="sy0">,</span><span class="br0">(</span><span class="br0">(</span><span class="nu0">4</span><span class="sy0">,</span><span class="nu0">3</span><span class="br0">)</span><span class="sy0">,</span>'P'<span class="br0">)</span><span class="sy0">,</span><span class="br0">(</span><span class="br0">(</span><span class="nu0">5</span><span class="sy0">,</span><span class="nu0">3</span><span class="br0">)</span><span class="sy0">,</span>'Y'<span class="br0">)</span><span class="sy0">,</span><span class="br0">(</span><span class="br0">(</span><span class="nu0">3</span><span class="sy0">,</span><span class="nu0">5</span><span class="br0">)</span><span class="sy0">,</span>'A'<span class="br0">)</span><span class="sy0">,</span><span class="br0">(</span><span class="br0">(</span><span class="nu0">4</span><span class="sy0">,</span><span class="nu0">5</span><span class="br0">)</span><span class="sy0">,</span>'R'<span class="br0">)</span><span class="sy0">,</span><span class="br0">(</span><span class="br0">(</span><span class="nu0">5</span><span class="sy0">,</span><span class="nu0">5</span><span class="br0">)</span><span class="sy0">,</span>'E'<span class="br0">)</span><span class="sy0">,</span><span class="br0">(</span><span class="br0">(</span>
<span class="nu0">6</span><span class="sy0">,</span><span class="nu0">5</span><span class="br0">)</span><span class="sy0">,</span>'S'<span class="br0">)</span><span class="br0">]</span><span class="br0">]</span></pre></div>
<p><a href="http://www.haskell.org/haskellwiki/99_questions/Solutions/99" title="99 questions/Solutions/99"> Solutions</a>
</p>
<!-- 
NewPP limit report
Preprocessor node count: 28/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
-->

<!-- Saved in parser cache with key wikidb:pcache:idhash:2506-0!1!0!1!en!2!edit=0 and timestamp 20130406060110 -->
<div class="printfooter">
Retrieved from "<a href="./99 questions 95 to 99 - HaskellWiki_files/99 questions 95 to 99 - HaskellWiki.html">http://www.haskell.org/haskellwiki/99_questions/95_to_99</a>"</div>
			<p class="catlinks"><a href="http://www.haskell.org/haskellwiki/Special:Categories" title="Special:Categories">Category</a>: <span dir="ltr"><a href="http://www.haskell.org/haskellwiki/Category:Tutorials" title="Category:Tutorials">Tutorials</a></span></p>			<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div></div>
		<div id="column-one">
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class="generated-sidebar portlet" id="p-navigation">
		<h5>Navigation</h5>
		<div class="pBody">
			<ul>
				<li id="n-mainpage"><a href="http://www.haskell.org/haskellwiki/Haskell" title="Visit the Main Page [ctrl-z]" accesskey="z">Haskell</a></li>
				<li id="n-portal"><a href="http://www.haskell.org/haskellwiki/HaskellWiki:Community" title="About the project, what you can do, where to find things">Wiki community</a></li>
				<li id="n-recentchanges"><a href="http://www.haskell.org/haskellwiki/Special:Recentchanges" title="The list of recent changes in the wiki. [ctrl-r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="http://www.haskell.org/haskellwiki/Special:Random" title="Load a random page [ctrl-x]" accesskey="x">Random page</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="http://www.haskell.org/haskellwiki/Special:Whatlinkshere/99_questions/95_to_99" title="List of all wiki pages that link here [ctrl-j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="http://www.haskell.org/haskellwiki/Special:Recentchangeslinked/99_questions/95_to_99" title="Recent changes in pages linked from this page [ctrl-k]" accesskey="k">Related changes</a></li>
<li id="t-upload"><a href="http://www.haskell.org/haskellwiki/Special:Upload" title="Upload files [ctrl-u]" accesskey="u">Upload file</a></li>
<li id="t-specialpages"><a href="http://www.haskell.org/haskellwiki/Special:Specialpages" title="List of all special pages [ctrl-q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="http://www.haskell.org/haskellwiki/index.php?title=99_questions/95_to_99&printable=yes" rel="alternate" title="Printable version of this page [ctrl-p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="http://www.haskell.org/haskellwiki/index.php?title=99_questions/95_to_99&oldid=36225" title="Permanent link to this version of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="./99 questions 95 to 99 - HaskellWiki_files/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki"></a></div>
			<ul id="f-list">
					<li id="lastmod"> This page was last modified 20:22, 15 July 2010.</li>
					<li id="viewcount">This page has been accessed 17,319 times.</li>
					<li id="copyright">Recent content is available under <a href="http://www.haskell.org/haskellwiki/HaskellWiki:Copyrights" title="HaskellWiki:Copyrights">a simple permissive license</a>.</li>
					<li id="privacy"><a href="http://www.haskell.org/haskellwiki/HaskellWiki:Privacy_policy" title="HaskellWiki:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="http://www.haskell.org/haskellwiki/HaskellWiki:About" title="HaskellWiki:About">About HaskellWiki</a></li>
					<li id="disclaimer"><a href="http://www.haskell.org/haskellwiki/HaskellWiki:General_disclaimer" title="HaskellWiki:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 0.138 secs. --><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-15375175-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<div id="directions_extension" style="display: none;"></div></body></html>